generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model user {
  id           Int                   @id @default(autoincrement())
  name         String
  lastname     String
  email        String                @unique
  phone        String
  password     String
  role         String                @default("user")
  createdAt    DateTime              @default(now())
  updatedAt    DateTime              @updatedAt

  reservations availabilityCalendar[] @relation("UserReservations")
}

model refreshToken {
  id        Int      @id @default(autoincrement())
  user_id   Int
  token     String   @unique
  expiresAt DateTime
}

enum roomStatus {
  available
  in_use
  maintenance
  closed
}

model room {
  id                    Int                    @id @default(autoincrement())
  name                  String
  description           String?
  floor                 Int?
  capacity              Int?
  imageUrl              String?
  status                roomStatus             @default(available)
  createdAt             DateTime               @default(now())
  updatedAt             DateTime               @updatedAt

  availabilityCalendars availabilityCalendar[]
}

model availabilityCalendar {
  id        Int      @id @default(autoincrement())
  roomId    Int
  room      room     @relation(fields: [roomId], references: [id])
  date      DateTime
  startTime String
  endTime   String
  users     Json
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  userReservations user[] @relation("UserReservations")
}

model reservationSettings {
  id         Int      @id @default(autoincrement())
  dayOfWeek  Int      @unique
  startTime  String
  endTime    String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}
